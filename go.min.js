function buildMap(t){var d=$(t).filter("div.xspj-body"),m={ztpjbl:$(d).data("ztpjbl"),jszdpjbl:$(d).data("jszdpjbl"),xykzpjbl:$(d).data("xykzpjbl"),jxb_id:$(d).data("jxb_id"),kch_id:$(d).data("kch_id"),jgh_id:$(d).data("jgh_id"),xsdm:$(d).data("xsdm")};i=0;var a=$(t).find("div.panel-pjdx"),s=a.attr("data-pjmbmcb_id"),o=a.attr("data-pjdxdm"),l=$("#"+s+"_py").val();m["modelList["+i+"].pjmbmcb_id"]=s,m["modelList["+i+"].pjdxdm"]=o,m["modelList["+i+"].py"]=$.founded(l)?encodeURIComponent(l):"",m["modelList["+i+"].xspfb_id"]=a.attr("data-xspfb_id");var f=0,x=!0;return a.find("table.table-xspj").each(function(t,d){var n=!1,r=0,a=$(d).find("tr.tr-xspj").size()-1,c=Math.round(Math.random()*a);$(d).find("tr.tr-xspj").each(function(t,d){var a=!1,s=$(d).attr("data-pjzbxm_id"),o=$(d).attr("data-pfdjdmb_id"),l=$(d).attr("data-zsmbmcb_id"),e=$(d).attr("data-dtlx");if("2"==e)if(0<$(d).find("div.form-group").size()){if(t==c&&x){var j=$(d).find("input[data-dyf='80']");x=!1}else j=$(d).find("input[data-dyf='95']");0<j.size()&&(a=!0,m["modelList["+i+"].xspjList["+f+"].childXspjList["+r+"].pfdjdmxmb_id"]=j.attr("data-pfdjdmxmb_id"))}else{j=$(d).find("input.form-control").val();$.founded(j)&&(a=!0,m["modelList["+i+"].xspjList["+f+"].childXspjList["+r+"].pjf"]=j)}else if("1"==e&&0<$(d).find("div.form-group").size()){var p=$(d).find("textarea.form-control").val();$.founded(p)&&(a=!0,m["modelList["+i+"].xspjList["+f+"].childXspjList["+r+"].zgpj"]=p)}a&&(n=!0,m["modelList["+i+"].xspjList["+f+"].childXspjList["+r+"].pjzbxm_id"]=s,m["modelList["+i+"].xspjList["+f+"].childXspjList["+r+"].pfdjdmb_id"]=o,m["modelList["+i+"].xspjList["+f+"].childXspjList["+r+"].zsmbmcb_id"]=l,r++)}),n&&(m["modelList["+i+"].xspjList["+f+"].pjzbxm_id"]=$(d).data("pjzbxm_id"),f++)}),m}console.log("Loading success...");var suc=0,fai=0;$("tr[data-tjzt='0']").length?console.log($("tr[data-tjzt='0']").length+"works founded.Start working..."):console.log("没有找到评价项目，请前往评价页面后重试！"),$("tr[data-tjzt='0']").map(function(i,a){$.ajax({type:"POST",async:!1,url:_path+"/xspjgl/xspj_cxXspjDisplay.html",data:{jxb_id:$(a).data("jxb_id"),kch_id:$(a).data("kch_id"),xsdm:$(a).data("xsdm"),jgh_id:$(a).data("jgh_id"),tjzt:$(a).data("tjzt"),pjmbmcb_id:$(a).data("pjmbmcb_id")},success:function(t){html=$.parseHTML(t);var d=buildMap(html);d.tjzt=0,$.ajax({type:"POST",async:!1,url:_path+"/xspjgl/xspj_bcXspj.html",data:d,datatype:"json",success:function(t){"string"==$.type(t)&&(-1<t.indexOf("成功")?(console.log("success "+$(a).text().trim().slice(2)+" "+t),suc++):-1<t.indexOf("失败")?(console.log("success 失败"),fai++):$.alert(t,function(){})),i==$("tr[data-tjzt='0']").size()-1&&(console.log("total:"+$("tr[data-tjzt='0']").size()+" success:"+suc+" fail:"+fai),suc==$("tr[data-tjzt='0']").size()&&(console.log("Congratulation!!(｡◕ˇ∀ˇ◕）不要忘记刷新后提交哦！！"),console.log("源码开源于https://github.com/pyinal/jxpj-rtf,（´◔౪◔）求颗Star")))},error:function(){console.log("error2"),i==$("tr[data-tjzt='0']").size()-1&&console.log("total:"+$("tr[data-tjzt='0']").size()+" success:"+suc+" fail:"+fai)}})},error:function(){console.log("error1")}})});